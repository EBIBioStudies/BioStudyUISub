<div class="row-offcanvas row-offcanvas-left">
    <subm-sidebar *ngIf="!readonly"
                  (toggle)="sideBarCollapsed=!sideBarCollapsed"
                  [collapsed]="sideBarCollapsed"
                  [section]="section">
    </subm-sidebar>

    <subm-navbar
            [class.collapse-left]="!readonly && sideBarCollapsed"
            [accno]="accno"
            [errors]="errors"
            [sectionPath]="sectionPath"
            (sectionClick)="onSectionClick($event)">
    </subm-navbar>

    <div class="container-fluid">
        <aside class="right-side"
               [ngClass]="{'collapse-left' : !readonly && sideBarCollapsed}">
            <div *ngIf="subm"
                 (change)="onChange($event)"
                 class="navbar-subm-margin">

                <subm-form [section]="section">
                </subm-form>

                <div class="list-group">
                    <label class="control-label" *ngIf="section.sections.list().length > 0">Subsections</label>
                    <div *ngFor="let subsection of section.sections.list()"
                          class="list-group-item">
                        {{subsection.typeName}}
                        <span *ngIf="subsection.accno">
                            : {{subsection.accno}}
                        </span>
                        <span class="btn-toolbar pull-right">
                            <button type="button" *ngIf="section.sections.isRemovable(subsection)" class="section-delete btn btn-danger btn-xs btn-flat"
                                    tooltip="delete"
                                    container="body"
                                    (click)="onSectionDelete(subsection)">
                                <i class="fa fa-trash-o fa-fw"></i>
                            </button>
                            <button type="button" class="section-edit btn btn-primary btn-xs btn-flat"
                                    tooltip="edit"
                                    container="body"
                                    (click)="onSectionClick(subsection)">
                                <!-- TODO: [ngClass]="{'list-group-item-danger': ...}" -->
                                <i class="fa fa-pencil fa-fw"></i>
                            </button>
                        </span>
                    </div>
                </div>

                <div class="row row-submit">
                    <p class="col-md-2">
                        <button type="button" class="btn-submit btn btn-md col-md-12"
                                [ngClass]="{'btn-primary': submValid, 'btn-danger': !submValid}"
                                [disabled]="isSubmitting || isSaving || readonly || !submValid"
                                (click)="onSubmit($event)">
                            Submit
                        </button>
                    </p>
                    <p class="text-muted col-md-10">
                        <span *ngIf="!submValid && !isSaving">Some information is missing or incorrect. Please, review the data before submitting.</span>
                        <i class="fa fa-cog fa-spin" *ngIf="isSubmitting || isSaving"></i>
                        <span *ngIf="isSubmitting">Submitting study...</span>
                        <span *ngIf="isSaving">Backing up study data...</span>
                    </p>
                </div>
            </div>
        </aside>
        <confirm-dialog #confirmDialog
                        headerTitle="Delete section"
                        body="You are about to permanently delete the section"
                        confirmLabel="Delete">
        </confirm-dialog>
    </div>
</div>