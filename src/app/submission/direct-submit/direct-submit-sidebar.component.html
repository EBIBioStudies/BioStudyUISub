<aside *ngIf="!readonly" class="left-side sidebar sidebar-offcanvas"
       [ngClass]="{'collapse-left' : collapsed}">
    <div class="menu-toggle">
        <button class="minimise-btn btn pull-right"
                [ngClass]="{'inactive': !collapsed}"
                [disabled]="editing"
                (click)="onToggle($event)"
                tooltip="{{collapsed ? 'Expand sidebar' : 'Collapse sidebar'}}"
                container="body"
                placement="right">
            <i class="fa fa-fw fa-lg"
               [ngClass]="{'fa-toggle-left': !collapsed, 'fa-toggle-right': collapsed}"></i>
        </button>
        <tabset [ngClass]="{'invisible': collapsed}">
            <tab heading="Upload form" active="true"></tab>
        </tabset>
    </div>
    <div *ngIf="collapsed" class="vertical-text">Upload form</div>
    <div class="sidebar-menu sidebar-contents clearfix" *ngIf="!collapsed">
        <form id="subm-upload-form"
              class="col-sm-12"
              name="submUploadForm"
              novalidate
              role="form"
              method="post"
              (ngSubmit)="onSubmit($event)"
              #uploadForm="ngForm">

            <div class="form-group" [ngClass]="{'has-error': !model.file && fileTouched}">
                <label class="control-label">Data file</label>
                <file-upload-button class="show"
                                    (select)="onUploadFilesSelect($event)">
                </file-upload-button>
                <p class="form-text"
                   [ngClass]="{'text-muted': !model.file, 'text-danger': !model.file && fileTouched}">{{fileName}}</p>
            </div>

            <div class="form-group">
                <label class="control-label">File format</label>
                <span class="text-muted pull-right"><i>Optional</i></span>
                <select name="formatSelect"
                        class="form-control"
                        [(ngModel)]="model.format">
                    <option *ngFor="let format of formats" [value]="format.value" [selected]="model.format === format.value">
                        {{format.name}}
                    </option>
                </select>
            </div>
            <div class="form-group">
                <label class="control-label">Projects</label>
                <span class="text-muted pull-right"><i>Optional</i></span>
                <ul *ngIf="model.projects.length > 0">
                    <li *ngFor="let p of model.projects">{{p}}</li>
                </ul>
                <p *ngIf="isBusy && !projectsToAttachTo.length" class="text-muted">
                    <i class="fa fa-cog fa-spin"></i>
                    Loading projects...
                </p>
                <multi-select
                        name="selectedProjects"
                        placeholder="Select one or more"
                        filterPlaceholder="Filter by name"
                        *ngIf="projectsToAttachTo.length"
                        [options]="projectsToAttachTo"
                        [(ngModel)]="model.projects"></multi-select>
            </div>
            <div class="btn-group" dropdown [isDisabled]="isBusy">
                <button id="single-button"
                        type="button"
                        class="btn-submit btn btn-primary"
                        dropdownToggle>
                    Submit as <span class="caret"></span>
                </button>
                <ul *dropdownMenu role="menu" aria-labelledby="single-button" class="dropdown-menu">
                    <li role="menuitem"><a class="dropdown-item" (click)="onSubmit('create')">New</a></li>
                    <li role="menuitem"><a class="dropdown-item" (click)="onSubmit('update')">Existing</a></li>
                </ul>
            </div>
        </form>
    </div>
</aside>