<st-container-root>
  <st-container-md>
    <div class="auth-content">
      <div class="alert" [ngClass]="{'alert-danger': hasError, 'invisible': !hasError}">
        {{hasError ? message : '&nbsp;'}}
      </div>
    </div>
    <p>
      <a routerLink="/signin"><i class="fa fa-chevron-circle-left" aria-hidden="true"></i> Back to Log in</a>
    </p>
    <div *ngIf="showSuccess">
      <h4 class="text-success">Password reset accepted</h4>
      <p>The link to reset your password has been sent to <strong>{{model.email}}</strong>. Please check your email,
        including the spam/trash folder.</p>
    </div>
    <div *ngIf="!showSuccess">
      <h4>Forgotten password</h4>
      <p>Please enter your email address and we will send you a link to reset your password. All fields are required.</p>
    </div>
    <div class="panel panel-default" *ngIf="!showSuccess">
      <div  class="panel-body">
        <form id="pwd-req-form" novalidate name="pwdReqForm" role="form"
            (ngSubmit)="onSubmit(pwdReqForm)" #pwdReqForm="ngForm">
          <div class="form-group" [ngClass]="{'has-error': email.invalid && email.touched}">
            <label class="control-label" for="email">
              <span class="text-black">Email address</span>
              <span *ngIf="email.invalid && email.touched">Please enter an email address</span>
            </label>
            <input type="email" id="email" name="email" autofocus
                 class="form-control"
                 [(ngModel)]="model.email"
                 (change)="resetGlobalError()"
                 #email="ngModel"
                 #emailEl
                 required
                 stValidateOnblur>
          </div>
          <div class="form-group" [ngClass]="{'has-error': captcha.invalid && (captcha.dirty || captcha.touched)}">
            <label class="control-label">
              <span class="text-black">Verify you are a human</span>
              <span *ngIf="captcha.invalid && (captcha.dirty || captcha.touched)">Please confirm you are not a robot</span>
            </label>
            <re-captcha (resolved)="onRecaptchaResolved($event)"
                  [(ngModel)]="model.captcha"
                  name="captcha"
                  #captcha="ngModel"
                  required
                  siteKey="6Lcmlv0SAAAAAHofnIcb29l1LMZsnGFcSlH8Reve"
                  class="captcha-root"
                  #recaptchaEl></re-captcha>
          </div>
          <div class="row-submit">
            <button type="submit" class="btn btn-primary btn-submit"
                [disabled]="isLoading">Get reset link</button>
            <div class="text-muted col-md-10">
              <span *ngIf="isLoading"><i class="fa fa-cog fa-spin"></i> Requesting reset...</span>
            </div>
          </div>
        </form>
      </div>
    </div>
  </st-container-md>
</st-container-root>
