<div ng-controller="PublicationCtrl">

<div class="panel panel-info" ng-if="(data|filter:{type:'Author'}).length >0">
    <!-- Default panel contents -->
    <div class="panel-heading">Publications <span class="badge">{{(data|filter:{type:'Publication'}).length}}</span>
        <!--<h4 tabindex="0" class="panel-title accordion-toggle">Panel heading
        </h4>-->
        <div class="btn-toolbar pull-right" role="toolbar">
            <div class="btn-group ">
                <button class="btn btn-xs btn-success"
                        uib-tooltip="Add a new publication"
                        tooltip-append-to-body="true"
                        tooltip-placement="bottom"
                        ng-click="onAdd(data);">Add a publication </button>
            </div>
        </div>

    </div>

    <ul class="list-group" ng-repeat="publication in data | filter:{type:'Publication'}" ng-form name="publicationForm">
        <a class="list-group-item">
            <table class="table table-condensed">
                <tbody>
                <tr>
                    <td colspan="2" class="border-none form-group-sm">
                        <p class="pull-right">
                            <button class="pull-right btn btn-danger btn-xs" ng-click="deleteItem($index, data)"
                                    uib-tooltip="Delete this author"
                                    tooltip-append-to-body="true"
                                    tooltip-placement="bottom">Delete this publication
                            </button>

                        </p>
                    </td>
                </tr>
                <tr ng-repeat="attribute in publication.attributes" ng-form name="atrPubForm">
                    <td class="col-md-3 nopadding border-none form-group" ms-form-group-validator>
                        <label class="control-label">Key<span
                                ng-show="atrLinkForm.attrPubKey.$error.required">: cannot be blank</span></label>

                        <input autocomplete="off" type="text" name="attrPubKey" ng-model="attribute.name"
                               uib-typeahead="item as item.name for item in typeHead | filter:$viewValue:$emptyOrMatch | limitTo:30"
                               typeahead-append-to-body="true"
                               typeahead-show-hint="true"
                               typeahead-min-length="0"
                               class="form-control control-label input-sm"
                               placeholder="Type a key" ng-required="true">
                    </td>

                    <td class="col-md-9 nopadding border-none form-group" ms-form-group-validator>
                        <label class="control-label">Value<span
                                ng-show="atrPubForm.attrPubValue.$error.required">: cannot be blank</span></label>

                        <p class="input-group">
                            <input type="text" name="attrPubValue" ng-model="attribute.value"
                                   class="form-control input-sm"
                                   placeholder="Enter a value" ng-required="true">
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-sm btn-danger btn-flat"
                                            ng-click="deleteItem($index, publication.attributes)">
                                        <i class="fa fa-trash-o"></i>
                                    </button>
                                </span>
                                                        <span class="input-group-btn">
                    <button type="button" class="btn btn-primary btn-flat btn-sm"
                            ng-click="getPubFromPmc(attribute.value, publication);" ng-if="attribute.name==='Pub. Med. Id'">
                        <i class="fa fa-search fa-fw"></i>
                    </button>
                </span>

                        </p>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" class="">
                        <p class="pull-right">
                            <button class="btn btn-primary btn-xs" ng-click="addAttribute(publication)"
                                    uib-tooltip="Add information about the publication"
                                    tooltip-append-to-body="true"
                                    tooltip-placement="bottom">Add an publication description
                            </button>

                        </p>
                    </td>
                </tr>
                </tbody>
            </table>

        </a>
    </ul>

    <div class="panel-footer"> &nbsp;
        <div class="btn-toolbar pull-right" role="toolbar">

            <div class="btn-group">
                <button class="btn btn-success btn-xs" ng-click="onAdd(data)"
                        uib-tooltip="Add a new author"
                        tooltip-append-to-body="true"
                        tooltip-placement="bottom">Add a publication

                </button>
            </div>
        </div>
    </div>


</div>

</div>


