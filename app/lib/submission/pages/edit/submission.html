<div class="row-offcanvas row-offcanvas-left">

    <aside class="left-side sidebar sidebar-offcanvas"
           ng-class="{'collapse-left' : uisettings.collapseLeftSide}"
           ng-if="!readOnly">
        <ul class="sidebar-menu">
            <bs-ng-toggle></bs-ng-toggle>
            <li class="success" bs-ng-item data-bs-click="addAnnotation();"
                data-toggle="uisettings.collapseLeftSide" data-item-text="Describe your study"
                data-item-class="fa-comment-o">
            </li>
            <li class="success" bs-ng-item data-bs-click="addFile();"
                data-toggle="uisettings.collapseLeftSide" data-item-text="Add a file" data-item-class="fa-file-o">
            </li>
            <li class="success" bs-ng-item data-bs-click="addContact();"
                data-toggle="uisettings.collapseLeftSide" data-item-text="Add a contact"
                data-item-class="fa-user">
            </li>
            <li class="success" bs-ng-item data-bs-click="addLink();"
                data-toggle="uisettings.collapseLeftSide" data-item-text="Add a link" data-item-class="fa-link">
            </li>
            <li class="success" bs-ng-item data-bs-click="addPublication();"
                data-toggle="uisettings.collapseLeftSide" data-item-text="Add a publication"
                data-item-class="fa-book">
            </li>
            <li class="warning" ng-disabled="submissionForm.$invalid" bs-ng-item
                data-bs-click="submit(submissionForm)"
                data-toggle="uisettings.collapseLeftSide" data-item-text="Submit"
                data-item-class="fa-database">
            </li>
            <li>
                <hr/>
            </li>
            <li class="success" ng-disabled="true">
                <a class="disabled-link" ng-show="uisettings.collapseLeftSide">
                    <i class="fa fa-check" ng-hide="saving"></i>
                    <i class="fa fa-spinner fa-spin-2x" ng-show="saving"></i>
                </a>

                <a class="disabled-link" ng-show="!uisettings.collapseLeftSide">
                    <i class="fa fa-check" ng-hide="saving"></i>
                    <i class="fa fa-spinner fa-spin-2x" ng-show="saving"></i>
                    <span ng-hide="saving">Saved</span>
                    <span ng-show="saving">Saving...</span>
                </a>
            </li>
        </ul>
    </aside>

    <div class="container-fluid">

        <!-- Right side column. Contains the navbar and content of the page -->
        <aside class="right-side content" ng-class="{'collapse-left' : uisettings.collapseLeftSide}">

            <div class="panel" ng-class="{'panel-danger': submissionForm.$invalid, 'panel-info':submissionForm.$valid}">
                <div class="panel-heading">
                    <span>Submission {{accno}}</span><span ng-if="!readOnly && submissionForm.$invalid"> << There are some validation errors. Please correct them before to proceed to submit >> </span>
                    <div class="pull-right" ng-if="readOnly">
                        <a class="pull-right btn btn-success btn-xs" ng-click="editSubmission()"
                           uib-tooltip="Create a new submission"
                           tooltip-append-to-body="true"
                           tooltip-placement="bottom">Edit
                        </a>
                    </div>
                </div>
                <div class="panel-body">

                    <form class="form-horizontal" autocomplete="off" novalidate role="form"
                          method="post" name="submissionForm">
                        <div class="form-group row margin-bottom-small padding-right-15"
                             ng-class="{'has-error':submissionForm.title.$invalid }">
                            <div class="col-sm-12 ">
                                <label class="control-label">Title
                                    <ng-messages for="submissionForm.title.$error" ng-if="submissionForm.title.$dirty">
                                        <ng-message when="required"><span>: cannot be blank</span></ng-message>
                                        <ng-message when="minlength"><span>: must be at least 50 characters</span>
                                        </ng-message>
                                    </ng-messages>
                                </label>
                                <input type="text" class="form-control" id="title" name="title"
                                       placeholder="Enter a title"
                                       ng-model="submission.title"
                                       ng-required="true"
                                       ng-readonly="readOnly"
                                       ng-minlength="50"
                                       ng-model-options="{ allowInvalid: true }">
                            </div>
                        </div>

                        <div class="form-group row margin-bottom-small padding-right-15"
                             ng-class="{'has-error':submissionForm.releaseDate.$invalid }">

                            <div class="col-sm-12">
                                <label class="control-label">Release date
                                    <ng-messages for="submissionForm.releaseDate.$error"
                                                 ng-if="submissionForm.releaseDate.$dirty">
                                        <ng-message when="required"><span>: cannot be blank</span></ng-message>
                                    </ng-messages>
                                </label>
                                <p class="input-group margin-bottom-none">
                                    <input type="text" name="releaseDate" class="form-control"
                                           uib-datepicker-popup="dd.MM.yyyy"
                                           datepicker-append-to-body="true"
                                           datepicker-options="dateOptions"
                                           is-open="opened"
                                           close-text="Close"
                                           ng-required="true"
                                           ng-click="openDatePicker($event)"
                                           ng-readonly="readOnly"
                                           ng-model="submission.releaseDate"
                                           ng-model-options="{ allowInvalid: true }"/>
                                    <span class="input-group-btn">
                                     <button type="button" class="btn btn-default" ng-click="openDatePicker($event)">
                                     <i class="fa fa-fw fa-calendar"></i></button>
                                </span>
                                </p>
                            </div>
                        </div>
                        <div class="form-group row margin-bottom-small padding-right-15"
                             ng-class="{'has-error':submissionForm.description.$invalid }">
                            <div class="col-sm-12 ">
                                <label class="control-label">Description
                                    <ng-messages for="submissionForm.description.$error"
                                                 ng-if="submissionForm.description.$dirty">
                                        <ng-message when="required"><span>: cannot be blank</span></ng-message>
                                        <ng-message when="minlength"><span>: must be at least 50 characters</span>
                                        </ng-message>
                                    </ng-messages>
                                </label>
                                <textarea id="description" name="description" class="msd-elastic form-control input-sm"
                                          ng-model="submission.description"
                                          ng-required="true"
                                          ng-readonly="readOnly" ng-minlength="50"
                                          ng-model-options="{ allowInvalid: true }"></textarea>
                            </div>
                        </div>

                        <p></p>

                        <div class="col-lg-12 padding-left-none">
                            <bs-panel
                                    data-ng-model="submission.annotations.items[0]"
                                    data-type="annotation"
                                    data-content-type="sectionItem"
                                    data-change="onSubmissionChange()"></bs-panel>

                            <bs-panel
                                    data-ng-model="submission.contacts"
                                    data-type="contact"
                                    data-content-type="section"
                                    data-change="onSubmissionChange()"></bs-panel>

                            <bs-panel
                                    data-ng-model="submission.links"
                                    data-type="link"
                                    data-content-type="section"
                                    data-change="onSubmissionChange()"></bs-panel>

                            <bs-panel
                                    data-ng-model="submission.files"
                                    data-type="file"
                                    data-content-type="fileSection"
                                    data-change="onSubmissionChange()"></bs-panel>

                            <bs-panel
                                    data-ng-model="submission.publications"
                                    data-type="publication"
                                    data-content-type="section"
                                    data-change="onSubmissionChange()"></bs-panel>
                        </div>
                        <div>
                            <button type="button" class="btn btn-primary btn-lg"
                                    ng-show="!readOnly && !submissionForm.$invalid"
                                    ng-click="submit(submissionForm)">Submit
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </aside>
    </div>
    <!-- /.right-side -->
</div>



